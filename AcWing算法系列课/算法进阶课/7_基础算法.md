# 7_基础算法

## Manacher算法

### manacher算法

题目：https://www.acwing.com/problem/content/description/3190/

题解：《算法竞赛》p555-Manacher

```c++
#include <cstdio>
#include <cstring>
#include <iostream>
#include <algorithm>

using LL = long long;
using std::cin, std::cout;

const int N = 1e7 + 5;

int n;
char A[N], S[N * 2];
int P[N * 2];

void extend()
{
    n = strlen(A);
    int k = 0;
    S[k++] = '$', S[k++] = '#';
    for (int i = 0; i < n; i++)
    {
        S[k++] = A[i];
        S[k++] = '#';
    }
    S[k++] = '&';
    n = k;
}

void manacher()
{
    int r = 0, c = 0;
    for (int i = 1; i < n - 1; i++)
    {
        if (i < r) P[i] = std::min(r - i, P[c * 2 - i]);
        else P[i] = 1;
        while (S[i + P[i]] == S[i - P[i]]) P[i]++;
        if (i + P[i] > r)
        {
            r = i + P[i];
            c = i;
        }
    }
}

int main()
{
    std::ios::sync_with_stdio(false);
    cin.tie(nullptr), cout.tie(nullptr);

    cin >> A;

    extend();
    
    manacher();

    int res = 0;
    for (int i = 1; i < n - 1; i++) res = std::max(res, P[i]);

    cout << --res << '\n';

    return 0;
}
```

